/*
 * uCharts (R)
 * 高性能跨平台图表库，支持H5、APP、小程序（微信/支付宝/百度/头条/QQ/360/快手）、Vue、Taro等支持canvas的框架平台
 * Copyright (C) 2018-2022 QIUN (R) 秋云 https://www.ucharts.cn All rights reserved.
 * Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )
 * 复制使用请保留本段注释，感谢支持开源！
 * 
 * uCharts (R) 官方网站
 * https://www.uCharts.cn
 * 
 * 开源地址:
 * https://gitee.com/uCharts/uCharts
 * 
 * uni-app插件市场地址：
 * http://ext.dcloud.net.cn/plugin?id=271
 * 
 */
"use strict";var config={version:"v2.4.3-20220505",yAxisWidth:15,xAxisHeight:22,xAxisTextPadding:3,padding:[10,10,10,10],pixelRatio:1,rotate:false,fontSize:13,fontColor:"#666666",dataPointShape:["circle","circle","circle","circle"],color:["#1890FF","#91CB74","#FAC858","#EE6666","#73C0DE","#3CA272","#FC8452","#9A60B4","#ea7ccc"],linearColor:["#0EE2F8","#2BDCA8","#FA7D8D","#EB88E2","#2AE3A0","#0EE2F8","#EB88E2","#6773E3","#F78A85"],titleFontSize:20,subtitleFontSize:15,toolTipPadding:3,toolTipBackground:"#000000",toolTipOpacity:.7,toolTipLineHeight:20};var assign=function(e,...t){if(e==null){throw new TypeError("[uCharts] Cannot convert undefined or null to object")}if(!t||t.length<=0){return e}function a(e,i){for(let t in i){e[t]=e[t]&&e[t].toString()==="[object Object]"?a(e[t],i[t]):e[t]=i[t]}return e}t.forEach(t=>{e=a(e,t)});return e};var util={toFixed:function t(e,i){i=i||2;if(this.isFloat(e)){e=e.toFixed(i)}return e},isFloat:function t(e){return e%1!==0},approximatelyEqual:function t(e,i){return Math.abs(e-i)<1e-10},isSameSign:function t(e,i){return Math.abs(e)===e&&Math.abs(i)===i||Math.abs(e)!==e&&Math.abs(i)!==i},isSameXCoordinateArea:function t(e,i){return this.isSameSign(e.x,i.x)},isCollision:function t(e,i){e.end={};e.end.x=e.start.x+e.width;e.end.y=e.start.y-e.height;i.end={};i.end.x=i.start.x+i.width;i.end.y=i.start.y-i.height;var a=i.start.x>e.end.x||i.end.x<e.start.x||i.end.y>e.start.y||i.start.y<e.end.y;return!a}};function getH5Offset(t){t.mp={changedTouches:[]};t.mp.changedTouches.push({x:t.offsetX,y:t.offsetY});return t}function hexToRgb(t,e){var i=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;var a=t.replace(i,function(t,e,i,a){return e+e+i+i+a+a});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);var o=parseInt(r[1],16);var n=parseInt(r[2],16);var s=parseInt(r[3],16);return"rgba("+o+","+n+","+s+","+e+")"}function findRange(t,e,i){if(isNaN(t)){throw new Error("[uCharts] series数据需为Number格式")}i=i||10;e=e?e:"upper";var a=1;while(i<1){i*=10;a*=10}if(e==="upper"){t=Math.ceil(t*a)}else{t=Math.floor(t*a)}while(t%i!==0){if(e==="upper"){if(t==t+1){break}t++}else{t--}}return t/a}function calValidDistance(t,e,i,a,r){var o=r.width-r.area[1]-r.area[3];var n=i.eachSpacing*(r.chartData.xAxisData.xAxisPoints.length-1);if(r.type=="mount"&&r.extra&&r.extra.mount&&r.extra.mount.widthRatio&&r.extra.mount.widthRatio>1){if(r.extra.mount.widthRatio>2)r.extra.mount.widthRatio=2;n+=(r.extra.mount.widthRatio-1)*i.eachSpacing}var s=e;if(e>=0){s=0;t.uevent.trigger("scrollLeft");t.scrollOption.position="left";r.xAxis.scrollPosition="left"}else if(Math.abs(e)>=n-o){s=o-n;t.uevent.trigger("scrollRight");t.scrollOption.position="right";r.xAxis.scrollPosition="right"}else{t.scrollOption.position=e;r.xAxis.scrollPosition=e}return s}function createCurveControlPoints(t,e){function i(t,e){if(t[e-1]&&t[e+1]){return t[e].y>=Math.max(t[e-1].y,t[e+1].y)||t[e].y<=Math.min(t[e-1].y,t[e+1].y)}else{return false}}function c(t,e){if(t[e-1]&&t[e+1]){return t[e].x>=Math.max(t[e-1].x,t[e+1].x)||t[e].x<=Math.min(t[e-1].x,t[e+1].x)}else{return false}}var a=.2;var r=.2;var o=null;var n=null;var s=null;var l=null;if(e<1){o=t[0].x+(t[1].x-t[0].x)*a;n=t[0].y+(t[1].y-t[0].y)*a}else{o=t[e].x+(t[e+1].x-t[e-1].x)*a;n=t[e].y+(t[e+1].y-t[e-1].y)*a}if(e>t.length-3){var h=t.length-1;s=t[h].x-(t[h].x-t[h-1].x)*r;l=t[h].y-(t[h].y-t[h-1].y)*r}else{s=t[e+1].x-(t[e+2].x-t[e].x)*r;l=t[e+1].y-(t[e+2].y-t[e].y)*r}if(i(t,e+1)){l=t[e+1].y}if(i(t,e)){n=t[e].y}if(c(t,e+1)){s=t[e+1].x}if(c(t,e)){o=t[e].x}if(n>=Math.max(t[e].y,t[e+1].y)||n<=Math.min(t[e].y,t[e+1].y)){n=t[e].y}if(l>=Math.max(t[e].y,t[e+1].y)||l<=Math.min(t[e].y,t[e+1].y)){l=t[e+1].y}if(o>=Math.max(t[e].x,t[e+1].x)||o<=Math.min(t[e].x,t[e+1].x)){o=t[e].x}if(s>=Math.max(t[e].x,t[e+1].x)||s<=Math.min(t[e].x,t[e+1].x)){s=t[e+1].x}return{ctrA:{x:o,y:n},ctrB:{x:s,y:l}}}function convertCoordinateOrigin(t,e,i){return{x:i.x+t,y:i.y-e}}function fixPieSeries(e,i,t){let a=[];if(e.length>0&&e[0].data.constructor.toString().indexOf("Array")>-1){i._pieSeries_=e;let t=e[0].data;for(var r=0;r<t.length;r++){t[r].formatter=e[0].formatter;t[r].data=t[r].value;a.push(t[r])}i.series=a}else{a=e}return a}function fillSeries(e,i,a){var r=0;for(var o=0;o<e.length;o++){let t=e[o];if(!t.color){t.color=a.color[r];r=(r+1)%a.color.length}if(!t.linearIndex){t.linearIndex=o}if(!t.index){t.index=0}if(!t.type){t.type=i.type}if(typeof t.show=="undefined"){t.show=true}if(!t.type){t.type=i.type}if(!t.pointShape){t.pointShape="circle"}if(!t.legendShape){switch(t.type){case"line":t.legendShape="line";break;case"column":case"bar":t.legendShape="rect";break;case"area":case"mount":t.legendShape="triangle";break;default:t.legendShape="circle"}}}return e}function fillCustomColor(t,e,i,a){var r=e||[];if(t=="custom"&&r.length==0){r=a.linearColor}if(t=="custom"&&r.length<i.length){let t=i.length-r.length;for(var o=0;o<t;o++){r.push(a.linearColor[(o+1)%a.linearColor.length])}}return r}function getDataRange(t,e){var i=0;var a=e-t;if(a>=1e4){i=1e3}else if(a>=1e3){i=100}else if(a>=100){i=10}else if(a>=10){i=5}else if(a>=1){i=1}else if(a>=.1){i=.1}else if(a>=.01){i=.01}else if(a>=.001){i=.001}else if(a>=1e-4){i=1e-4}else if(a>=1e-5){i=1e-5}else{i=1e-6}return{minRange:findRange(t,"lower",i),maxRange:findRange(e,"upper",i)}}function measureText(i,t,e){var a=0;i=String(i);e=false;if(e!==false&&e!==undefined&&e.setFontSize&&e.measureText){e.setFontSize(t);return e.measureText(i).width}else{var i=i.split("");for(let e=0;e<i.length;e++){let t=i[e];if(/[a-zA-Z]/.test(t)){a+=7}else if(/[0-9]/.test(t)){a+=5.5}else if(/\./.test(t)){a+=2.7}else if(/-/.test(t)){a+=3.25}else if(/:/.test(t)){a+=2.5}else if(/[\u4e00-\u9fa5]/.test(t)){a+=10}else if(/\(|\)/.test(t)){a+=3.73}else if(/\s/.test(t)){a+=2.5}else if(/%/.test(t)){a+=8}else{a+=10}}return a*t/10}}function dataCombine(t){return t.reduce(function(t,e){return(t.data?t.data:t).concat(e.data)},[])}function dataCombineStack(t,e){var i=new Array(e);for(var a=0;a<i.length;a++){i[a]=0}for(var r=0;r<t.length;r++){for(var a=0;a<i.length;a++){i[a]+=t[r].data[a]}}return t.reduce(function(t,e){return(t.data?t.data:t).concat(e.data).concat(i)},[])}function getTouches(t,e,i){let a,r;if(t.clientX){if(e.rotate){r=e.height-t.clientX*e.pix;a=(t.pageY-i.currentTarget.offsetTop-e.height/e.pix/2*(e.pix-1))*e.pix}else{a=t.clientX*e.pix;r=(t.pageY-i.currentTarget.offsetTop-e.height/e.pix/2*(e.pix-1))*e.pix}}else{if(e.rotate){r=e.height-t.x*e.pix;a=t.y*e.pix}else{a=t.x*e.pix;r=t.y*e.pix}}return{x:a,y:r}}function getSeriesDataItem(e,a,i){var r=[];var o=[];var n=a.constructor.toString().indexOf("Array")>-1;if(n){let t=filterSeries(e);for(var s=0;s<i.length;s++){o.push(t[i[s]])}}else{o=e}for(let t=0;t<o.length;t++){let e=o[t];let i=-1;if(n){i=a[t]}else{i=a}if(e.data[i]!==null&&typeof e.data[i]!=="undefined"&&e.show){let t={};t.color=e.color;t.type=e.type;t.style=e.style;t.pointShape=e.pointShape;t.disableLegend=e.disableLegend;t.name=e.name;t.show=e.show;t.data=e.formatter?e.formatter(e.data[i]):e.data[i];r.push(t)}}return r}function getToolTipData(t,i,a,r,o){var n=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{};var s=i.chartData.calPoints?i.chartData.calPoints:[];let l={};if(r.length>0){let e=[];for(let t=0;t<r.length;t++){e.push(s[r[t]])}l=e[0][a[0]]}else{for(let t=0;t<s.length;t++){if(s[t][a]){l=s[t][a];break}}}var e=t.map(function(t){let e=null;if(i.categories&&i.categories.length>0){e=o[a]}return{text:n.formatter?n.formatter(t,e,a,i):t.name+": "+t.data,color:t.color}});var h={x:Math.round(l.x),y:Math.round(l.y)};return{textList:e,offset:h}}function filterSeries(e){let i=[];for(let t=0;t<e.length;t++){if(e[t].show==true){i.push(e[t])}}return i}function findCurrentIndex(o,n,e,t){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var s={index:-1,group:[]};var a=e.chartData.eachSpacing/2;let r=[];if(n&&n.length>0){if(!e.categories){a=0}else{for(let t=1;t<e.chartData.xAxisPoints.length;t++){r.push(e.chartData.xAxisPoints[t]-a)}if((e.type=="line"||e.type=="area")&&e.xAxis.boundaryGap=="justify"){r=e.chartData.xAxisPoints}}if(isInExactChartArea(o,e,t)){if(!e.categories){let i=Array(n.length);for(let e=0;e<n.length;e++){i[e]=Array(n[e].length);for(let t=0;t<n[e].length;t++){i[e][t]=Math.abs(n[e][t].x-o.x)}}let e=Array(i.length);let a=Array(i.length);for(let t=0;t<i.length;t++){e[t]=Math.min.apply(null,i[t]);a[t]=i[t].indexOf(e[t])}let r=Math.min.apply(null,e);s.index=[];for(let t=0;t<e.length;t++){if(e[t]==r){s.group.push(t);s.index.push(a[t])}}}else{r.forEach(function(t,e){if(o.x+i+a>t){s.index=e}})}}}return s}function findLegendIndex(o,t,e){let n=-1;let s=0;if(isInExactLegendArea(o,t.area)){let a=t.points;let r=-1;for(let t=0,e=a.length;t<e;t++){let i=a[t];for(let e=0;e<i.length;e++){r+=1;let t=i[e]["area"];if(t&&o.x>t[0]-s&&o.x<t[2]+s&&o.y>t[1]-s&&o.y<t[3]+s){n=r;break}}}return n}return n}function isInExactLegendArea(t,e){return t.x>e.start.x&&t.x<e.end.x&&t.y>e.start.y&&t.y<e.end.y}function isInExactChartArea(t,e,i){return t.x<=e.width-e.area[1]+10&&t.x>=e.area[3]-10&&t.y>=e.area[0]&&t.y<=e.height-e.area[2]}function splitPoints(t,i){var a=[];var r=[];t.forEach(function(t,e){if(i.connectNulls){if(t!==null){r.push(t)}}else{if(t!==null){r.push(t)}else{if(r.length){a.push(r)}r=[]}}});if(r.length){a.push(r)}return a}function calLegendData(s,l,e,t,h){let c={area:{start:{x:0,y:0},end:{x:0,y:0},width:0,height:0,wholeWidth:0,wholeHeight:0},points:[],widthArr:[],heightArr:[]};if(l.legend.show===false){t.legendData=c;return c}let x=l.legend.padding*l.pix;let f=l.legend.margin*l.pix;let p=l.legend.fontSize?l.legend.fontSize*l.pix:e.fontSize;let d=15*l.pix;let g=5*l.pix;let u=Math.max(l.legend.lineHeight*l.pix,p);if(l.legend.position=="top"||l.legend.position=="bottom"){let a=[];let r=0;let o=[];let n=[];for(let i=0;i<s.length;i++){let t=s[i];const y=t.legendText?t.legendText:t.name;let e=d+g+measureText(y||"undefined",p,h)+l.legend.itemGap*l.pix;if(r+e>l.width-l.area[1]-l.area[3]){a.push(n);o.push(r-l.legend.itemGap*l.pix);r=e;n=[t]}else{r+=e;n.push(t)}}if(n.length){a.push(n);o.push(r-l.legend.itemGap*l.pix);c.widthArr=o;let t=Math.max.apply(null,o);switch(l.legend.float){case"left":c.area.start.x=l.area[3];c.area.end.x=l.area[3]+t+2*x;break;case"right":c.area.start.x=l.width-l.area[1]-t-2*x;c.area.end.x=l.width-l.area[1];break;default:c.area.start.x=(l.width-t)/2-x;c.area.end.x=(l.width+t)/2+x}c.area.width=t+2*x;c.area.wholeWidth=t+2*x;c.area.height=a.length*u+2*x;c.area.wholeHeight=a.length*u+2*x+2*f;c.points=a}}else{let t=s.length;let e=l.height-l.area[0]-l.area[2]-2*f-2*x;let i=Math.min(Math.floor(e/u),t);c.area.height=i*u+x*2;c.area.wholeHeight=i*u+x*2;switch(l.legend.float){case"top":c.area.start.y=l.area[0]+f;c.area.end.y=l.area[0]+f+c.area.height;break;case"bottom":c.area.start.y=l.height-l.area[2]-f-c.area.height;c.area.end.y=l.height-l.area[2]-f;break;default:c.area.start.y=(l.height-c.area.height)/2;c.area.end.y=(l.height+c.area.height)/2}let a=t%i===0?t/i:Math.floor(t/i+1);let r=[];for(let e=0;e<a;e++){let t=s.slice(e*i,e*i+i);r.push(t)}c.points=r;if(r.length){for(let t=0;t<r.length;t++){let i=r[t];let a=0;for(let e=0;e<i.length;e++){let t=d+g+measureText(i[e].name||"undefined",p,h)+l.legend.itemGap*l.pix;if(t>a){a=t}}c.widthArr.push(a);c.heightArr.push(i.length*u+x*2)}let e=0;for(let t=0;t<c.widthArr.length;t++){e+=c.widthArr[t]}c.area.width=e-l.legend.itemGap*l.pix+2*x;c.area.wholeWidth=c.area.width+x}}switch(l.legend.position){case"top":c.area.start.y=l.area[0]+f;c.area.end.y=l.area[0]+f+c.area.height;break;case"bottom":c.area.start.y=l.height-l.area[2]-c.area.height-f;c.area.end.y=l.height-l.area[2]-f;break;case"left":c.area.start.x=l.area[3];c.area.end.x=l.area[3]+c.area.width;break;case"right":c.area.start.x=l.width-l.area[1]-c.area.width;c.area.end.x=l.width-l.area[1];break}t.legendData=c;return c}function calCategoriesData(t,a,e,i,r){var o={angle:0,xAxisHeight:e.xAxisHeight};var n=a.xAxis.fontSize*a.pix||e.fontSize;var s=t.map(function(t,e){var i=a.xAxis.formatter?a.xAxis.formatter(t,e,a):t;return measureText(String(i),n,r)});var l=Math.max.apply(this,s);if(a.xAxis.rotateLabel==true){o.angle=a.xAxis.rotateAngle*Math.PI/180;let t=2*e.xAxisTextPadding+Math.abs(l*Math.sin(o.angle));t=t<n+2*e.xAxisTextPadding?t+2*e.xAxisTextPadding:t;if(a.enableScroll==true&&a.xAxis.scrollShow==true){t+=12*a.pix}o.xAxisHeight=t}if(a.xAxis.disabled){o.xAxisHeight=0}return o}function getXAxisTextList(t,e,h,c){var i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:-1;var a;if(c=="stack"){a=dataCombineStack(t,e.categories.length)}else{a=dataCombine(t)}var r=[];a=a.filter(function(t){if(typeof t==="object"&&t!==null){if(t.constructor.toString().indexOf("Array")>-1){return t!==null}else{return t.value!==null}}else{return t!==null}});a.map(function(t){if(typeof t==="object"){if(t.constructor.toString().indexOf("Array")>-1){if(e.type=="candle"){t.map(function(t){r.push(t)})}else{r.push(t[0])}}else{r.push(t.value)}}else{r.push(t)}});var o=0;var n=0;if(r.length>0){o=Math.min.apply(this,r);n=Math.max.apply(this,r)}if(i>-1){if(typeof e.xAxis.data[i].min==="number"){o=Math.min(e.xAxis.data[i].min,o)}if(typeof e.xAxis.data[i].max==="number"){n=Math.max(e.xAxis.data[i].max,n)}}else{if(typeof e.xAxis.min==="number"){o=Math.min(e.xAxis.min,o)}if(typeof e.xAxis.max==="number"){n=Math.max(e.xAxis.max,n)}}if(o===n){var x=n||10;n+=x}var s=o;var f=n;var p=[];var d=(f-s)/e.xAxis.splitNumber;for(var l=0;l<=e.xAxis.splitNumber;l++){p.push(s+d*l)}return p}function calXAxisData(t,e,i,a){var r=assign({},{type:""},e.extra.bar);var o={angle:0,xAxisHeight:i.xAxisHeight};o.ranges=getXAxisTextList(t,e,i,r.type);o.rangesFormat=o.ranges.map(function(t){t=util.toFixed(t,2);return t});var n=o.ranges.map(function(t){t=util.toFixed(t,2);return t});o=Object.assign(o,getXAxisPoints(n,e,i));var s=o.eachSpacing;var l=n.map(function(t){return measureText(t,e.xAxis.fontSize*e.pix||i.fontSize,a)});var h=Math.max.apply(this,l);if(h+2*i.xAxisTextPadding>s){o.angle=45*Math.PI/180;o.xAxisHeight=2*i.xAxisTextPadding+h*Math.sin(o.angle)}if(e.xAxis.disabled===true){o.xAxisHeight=0}return o}function getArcbarDataPoints(a,r){var o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;if(o==1){o=.999999}for(let i=0;i<a.length;i++){let t=a[i];t.data=t.data===null?0:t.data;let e;if(r.type=="circle"){e=2}else{if(r.endAngle<r.startAngle){e=2+r.endAngle-r.startAngle}else{e=r.startAngle-r.endAngle}}t._proportion_=e*t.data*o+r.startAngle;if(t._proportion_>=2){t._proportion_=t._proportion_%2}}return a}function fixColumeData(t,a,r,o,e,n){return t.map(function(t){if(t===null){return null}var e=0;var i=0;if(n.type=="mix"){e=n.extra.mix.column.seriesGap*n.pix||0;i=n.extra.mix.column.categoryGap*n.pix||0}else{e=n.extra.column.seriesGap*n.pix||0;i=n.extra.column.categoryGap*n.pix||0}e=Math.min(e,a/r);i=Math.min(i,a/r);t.width=Math.ceil((a-2*i-e*(r-1))/r);if(n.extra.mix&&n.extra.mix.column.width&&+n.extra.mix.column.width>0){t.width=Math.min(t.width,+n.extra.mix.column.width*n.pix)}if(n.extra.column&&n.extra.column.width&&+n.extra.column.width>0){t.width=Math.min(t.width,+n.extra.column.width*n.pix)}if(t.width<=0){t.width=1}t.x+=(o+.5-r/2)*(t.width+e);return t})}function fixColumeMeterData(t,e,i,a,r,o,n){var s=o.extra.column.categoryGap*o.pix||0;return t.map(function(t){if(t===null){return null}t.width=e-2*s;if(o.extra.column&&o.extra.column.width&&+o.extra.column.width>0){t.width=Math.min(t.width,+o.extra.column.width*o.pix)}if(a>0){t.width-=n}return t})}function fixColumeStackData(t,i,e,a,r,o,n){var s=o.extra.column.categoryGap*o.pix||0;return t.map(function(t,e){if(t===null){return null}t.width=Math.ceil(i-2*s);if(o.extra.column&&o.extra.column.width&&+o.extra.column.width>0){t.width=Math.min(t.width,+o.extra.column.width*o.pix)}if(t.width<=0){t.width=1}return t})}function getXAxisPoints(t,e,h){var i=e.width-e.area[1]-e.area[3];var a=e.enableScroll?Math.min(e.xAxis.itemCount,t.length):t.length;if((e.type=="line"||e.type=="area"||e.type=="scatter"||e.type=="bubble"||e.type=="bar")&&a>1&&e.xAxis.boundaryGap=="justify"){a-=1}var r=0;if(e.type=="mount"&&e.extra&&e.extra.mount&&e.extra.mount.widthRatio&&e.extra.mount.widthRatio>1){if(e.extra.mount.widthRatio>2)e.extra.mount.widthRatio=2;r=e.extra.mount.widthRatio-1;a+=r}var o=i/a;var n=[];var s=e.area[3];var l=e.width-e.area[1];t.forEach(function(t,e){n.push(s+r/2*o+e*o)});if(e.xAxis.boundaryGap!=="justify"){if(e.enableScroll===true){n.push(s+r*o+t.length*o)}else{n.push(l)}}return{xAxisPoints:n,startX:s,endX:l,eachSpacing:o}}function getDataPoints(t,i,n,s,l,h,e){var c=arguments.length>7&&arguments[7]!==undefined?arguments[7]:1;var x="center";if(h.type=="line"||h.type=="area"||h.type=="scatter"||h.type=="bubble"){x=h.xAxis.boundaryGap}var f=[];var p=h.height-h.area[0]-h.area[2];var d=h.width-h.area[1]-h.area[3];t.forEach(function(a,t){if(a===null){f.push(null)}else{var r={};r.color=a.color;r.x=s[t];var o=a;if(typeof a==="object"&&a!==null){if(a.constructor.toString().indexOf("Array")>-1){let t,e,i;t=[].concat(h.chartData.xAxisData.ranges);e=t.shift();i=t.pop();o=a[1];r.x=h.area[3]+d*(a[0]-e)/(i-e);if(h.type=="bubble"){r.r=a[2];r.t=a[3]}}else{o=a.value}}if(x=="center"){r.x+=l/2}var e=p*(o-i)/(n-i);e*=c;r.y=h.height-e-h.area[2];f.push(r)}});return f}function getStackDataPoints(t,l,h,c,g,x,e,f,y){var p=arguments.length>9&&arguments[9]!==undefined?arguments[9]:1;var d=[];var u=x.height-x.area[0]-x.area[2];t.forEach(function(t,e){if(t===null){d.push(null)}else{var i={};i.color=t.color;i.x=c[e]+Math.round(g/2);if(f>0){var a=0;for(let t=0;t<=f;t++){a+=y[t].data[e]}var r=a-t;var o=u*(a-l)/(h-l);var n=u*(r-l)/(h-l)}else{var a=t;var o=u*(a-l)/(h-l);var n=0}var s=n;o*=p;s*=p;i.y=x.height-Math.round(o)-x.area[2];i.y0=x.height-Math.round(s)-x.area[2];d.push(i)}});return d}function getYAxisTextList(t,e,h,c,i){var x=arguments.length>5&&arguments[5]!==undefined?arguments[5]:-1;var a;if(c=="stack"){a=dataCombineStack(t,e.categories.length)}else{a=dataCombine(t)}var r=[];a=a.filter(function(t){if(typeof t==="object"&&t!==null){if(t.constructor.toString().indexOf("Array")>-1){return t!==null}else{return t.value!==null}}else{return t!==null}});a.map(function(t){if(typeof t==="object"){if(t.constructor.toString().indexOf("Array")>-1){if(e.type=="candle"){t.map(function(t){r.push(t)})}else{r.push(t[1])}}else{r.push(t.value)}}else{r.push(t)}});var o=i.min||0;var n=i.max||0;if(r.length>0){o=Math.min.apply(this,r);n=Math.max.apply(this,r)}if(o===n){if(n==0){n=10}else{o=0}}var s=getDataRange(o,n);var f=i.min===undefined||i.min===null?s.minRange:i.min;var p=i.max===undefined||i.max===null?s.maxRange:i.max;var d=[];var u=(p-f)/e.yAxis.splitNumber;for(var l=0;l<=e.yAxis.splitNumber;l++){d.push(f+u*l)}return d.reverse()}function calYAxisData(i,o,e,n){var s=assign({},{type:""},o.extra.column);var t=o.yAxis.data.length;var l=new Array(t);if(t>0){for(let e=0;e<t;e++){l[e]=[];for(let t=0;t<i.length;t++){if(i[t].index==e){l[e].push(i[t])}}}var h=new Array(t);var c=new Array(t);var x=new Array(t);for(let r=0;r<t;r++){let a=o.yAxis.data[r];if(o.yAxis.disabled==true){a.disabled=true}if(a.type==="categories"){if(!a.formatter){a.formatter=(t,e,i)=>{return t+(a.unit||"")}}a.categories=a.categories||o.categories;h[r]=a.categories}else{if(!a.formatter){a.formatter=(t,e,i)=>{return t.toFixed(a.tofix)+(a.unit||"")}}h[r]=getYAxisTextList(l[r],o,e,s.type,a,r)}let i=a.fontSize*o.pix||e.fontSize;x[r]={position:a.position?a.position:"left",width:0};c[r]=h[r].map(function(t,e){t=a.formatter(t,e,o);x[r].width=Math.max(x[r].width,measureText(t,i,n)+5);return t});let t=a.calibration?4*o.pix:0;x[r].width+=t+3*o.pix;if(a.disabled===true){x[r].width=0}}}else{var h=new Array(1);var c=new Array(1);var x=new Array(1);if(o.type==="bar"){h[0]=o.categories;if(!o.yAxis.formatter){o.yAxis.formatter=(t,e,i)=>{return t+(i.yAxis.unit||"")}}}else{if(!o.yAxis.formatter){o.yAxis.formatter=(t,e,i)=>{return t.toFixed(i.yAxis.tofix)+(i.yAxis.unit||"")}}h[0]=getYAxisTextList(i,o,e,s.type,{})}x[0]={position:"left",width:0};var a=o.yAxis.fontSize*o.pix||e.fontSize;c[0]=h[0].map(function(t,e){t=o.yAxis.formatter(t,e,o);x[0].width=Math.max(x[0].width,measureText(t,a,n)+5);return t});x[0].width+=3*o.pix;if(o.yAxis.disabled===true){x[0]={position:"left",width:0};o.yAxis.data[0]={disabled:true}}else{o.yAxis.data[0]={disabled:false,position:"left",max:o.yAxis.max,min:o.yAxis.min,formatter:o.yAxis.formatter};if(o.type==="bar"){o.yAxis.data[0].categories=o.categories;o.yAxis.data[0].type="categories"}}}return{rangesFormat:c,ranges:h,yAxisWidth:x}}function calTooltipYAxisData(r,t,o,e,i){let n=[].concat(o.chartData.yAxisData.ranges);let s=o.height-o.area[0]-o.area[2];let l=o.area[0];let h=[];for(let a=0;a<n.length;a++){let t=n[a].shift();let e=n[a].pop();let i=t-(t-e)*(r-l)/s;i=o.yAxis.data[a].formatter?o.yAxis.data[a].formatter(i):i.toFixed(0);h.push(String(i))}return h}function calMarkLineData(a,r){let o,n;let s=r.height-r.area[0]-r.area[2];for(let i=0;i<a.length;i++){a[i].yAxisIndex=a[i].yAxisIndex?a[i].yAxisIndex:0;let t=[].concat(r.chartData.yAxisData.ranges[a[i].yAxisIndex]);o=t.pop();n=t.shift();let e=s*(a[i].value-o)/(n-o);a[i].y=r.height-Math.round(e)-r.area[2]}return a}function contextRotate(t,e){if(e.rotateLock!==true){t.translate(e.height,0);t.rotate(90*Math.PI/180)}else if(e._rotate_!==true){t.translate(e.height,0);t.rotate(90*Math.PI/180);e._rotate_=true}}function drawPointShape(t,e,i,a,r){a.beginPath();if(r.dataPointShapeType=="hollow"){a.setStrokeStyle(e);a.setFillStyle(r.background);a.setLineWidth(2*r.pix)}else{a.setStrokeStyle("#ffffff");a.setFillStyle(e);a.setLineWidth(1*r.pix)}if(i==="diamond"){t.forEach(function(t,e){if(t!==null){a.moveTo(t.x,t.y-4.5);a.lineTo(t.x-4.5,t.y);a.lineTo(t.x,t.y+4.5);a.lineTo(t.x+4.5,t.y);a.lineTo(t.x,t.y-4.5)}})}else if(i==="circle"){t.forEach(function(t,e){if(t!==null){a.moveTo(t.x+2.5*r.pix,t.y);a.arc(t.x,t.y,3*r.pix,0,2*Math.PI,false)}})}else if(i==="square"){t.forEach(function(t,e){if(t!==null){a.moveTo(t.x-3.5,t.y-3.5);a.rect(t.x-3.5,t.y-3.5,7,7)}})}else if(i==="triangle"){t.forEach(function(t,e){if(t!==null){a.moveTo(t.x,t.y-4.5);a.lineTo(t.x-4.5,t.y+4.5);a.lineTo(t.x+4.5,t.y+4.5);a.lineTo(t.x,t.y-4.5)}})}else if(i==="triangle"){return}a.closePath();a.fill();a.stroke()}function drawRingTitle(t,e,i,a){var r=t.title.fontSize||e.titleFontSize;var o=t.subtitle.fontSize||e.subtitleFontSize;var n=t.title.name||"";var s=t.subtitle.name||"";var c=t.title.color||t.fontColor;var x=t.subtitle.color||t.fontColor;var f=n?r:0;var p=s?o:0;var l=5;if(s){var d=measureText(s,o*t.pix,i);var u=a.x-d/2+(t.subtitle.offsetX||0)*t.pix;var h=a.y+o*t.pix/2+(t.subtitle.offsetY||0)*t.pix;if(n){h+=(f*t.pix+l)/2}i.beginPath();i.setFontSize(o*t.pix);i.setFillStyle(x);i.fillText(s,u,h);i.closePath();i.stroke()}if(n){var g=measureText(n,r*t.pix,i);var y=a.x-g/2+(t.title.offsetX||0);var m=a.y+r*t.pix/2+(t.title.offsetY||0)*t.pix;if(s){m-=(p*t.pix+l)/2}i.beginPath();i.setFontSize(r*t.pix);i.setFillStyle(c);i.fillText(n,y,m);i.closePath();i.stroke()}}function drawPointText(t,o,n,s,l){var h=o.data;var c=o.textOffset?o.textOffset:0;t.forEach(function(t,e){if(t!==null){s.beginPath();var i=o.textSize?o.textSize*l.pix:n.fontSize;s.setFontSize(i);s.setFillStyle(o.textColor||l.fontColor);var a=h[e];if(typeof h[e]==="object"&&h[e]!==null){if(h[e].constructor.toString().indexOf("Array")>-1){a=h[e][1]}else{a=h[e].value}}var r=o.formatter?o.formatter(a,e,o,l):a;s.setTextAlign("center");s.fillText(String(r),t.x,t.y-4+c*l.pix);s.closePath();s.stroke();s.setTextAlign("left")}})}function drawMountPointText(t,o,n,s,l){var e=o.data;var h=o.textOffset?o.textOffset:0;t.forEach(function(t,e){if(t!==null){s.beginPath();var i=o[e].textSize?o[e].textSize*l.pix:n.fontSize;s.setFontSize(i);s.setFillStyle(o[e].textColor||l.fontColor);var a=t.value;var r=o[e].formatter?o[e].formatter(a,e,o,l):a;s.setTextAlign("center");s.fillText(String(r),t.x,t.y-4+h*l.pix);s.closePath();s.stroke();s.setTextAlign("left")}})}function drawToolTipSplitLine(r,o,n,s){var l=o.extra.tooltip||{};l.gridType=l.gridType==undefined?"solid":l.gridType;l.dashLength=l.dashLength==undefined?4:l.dashLength;var t=o.area[0];var h=o.height-o.area[2];if(l.gridType=="dash"){s.setLineDash([l.dashLength,l.dashLength])}s.setStrokeStyle(l.gridColor||"#cccccc");s.setLineWidth(1*o.pix);s.beginPath();s.moveTo(r,t);s.lineTo(r,h);s.stroke();s.setLineDash([]);if(l.xAxisLabel){let t=o.categories[o.tooltip.index];s.setFontSize(n.fontSize);let e=measureText(t,n.fontSize,s);let i=r-.5*e;let a=h;s.beginPath();s.setFillStyle(hexToRgb(l.labelBgColor||n.toolTipBackground,l.labelBgOpacity||n.toolTipOpacity));s.setStrokeStyle(l.labelBgColor||n.toolTipBackground);s.setLineWidth(1*o.pix);s.rect(i-n.toolTipPadding,a,e+2*n.toolTipPadding,n.fontSize+2*n.toolTipPadding);s.closePath();s.stroke();s.fill();s.beginPath();s.setFontSize(n.fontSize);s.setFillStyle(l.labelFontColor||o.fontColor);s.fillText(String(t),i,a+n.toolTipPadding+n.fontSize);s.closePath();s.stroke()}}function drawMarkLine(l,h,c){let e=assign({},{type:"solid",dashLength:4,data:[]},l.extra.markLine);let i=l.area[3];let a=l.width-l.area[1];let r=calMarkLineData(e.data,l);for(let t=0;t<r.length;t++){let s=assign({},{lineColor:"#DE4A42",showLabel:false,labelFontColor:"#666666",labelBgColor:"#DFE8FF",labelBgOpacity:.8,labelAlign:"left",labelOffsetX:0,labelOffsetY:0},r[t]);if(e.type=="dash"){c.setLineDash([e.dashLength,e.dashLength])}c.setStrokeStyle(s.lineColor);c.setLineWidth(1*l.pix);c.beginPath();c.moveTo(i,s.y);c.lineTo(a,s.y);c.stroke();c.setLineDash([]);if(s.showLabel){let t=s.labelText?s.labelText:s.value;c.setFontSize(h.fontSize);let e=measureText(t,h.fontSize,c);let i=e+h.toolTipPadding*2;let a=s.labelAlign=="left"?l.area[3]-i:l.width-l.area[1];a+=s.labelOffsetX;let r=s.y-.5*h.fontSize-h.toolTipPadding;r+=s.labelOffsetY;let o=a+h.toolTipPadding;let n=s.y;c.setFillStyle(hexToRgb(s.labelBgColor,s.labelBgOpacity));c.setStrokeStyle(s.labelBgColor);c.setLineWidth(1*l.pix);c.beginPath();c.rect(a,r,i,h.fontSize+2*h.toolTipPadding);c.closePath();c.stroke();c.fill();c.setFontSize(h.fontSize);c.setTextAlign("left");c.setFillStyle(s.labelFontColor);c.fillText(String(t),o,r+h.fontSize+h.toolTipPadding/2);c.stroke();c.setTextAlign("left")}}}function drawToolTipHorizentalLine(x,f,p,t,e){var d=assign({},{gridType:"solid",dashLength:4},x.extra.tooltip);var i=x.area[3];var a=x.width-x.area[1];if(d.gridType=="dash"){p.setLineDash([d.dashLength,d.dashLength])}p.setStrokeStyle(d.gridColor||"#cccccc");p.setLineWidth(1*x.pix);p.beginPath();p.moveTo(i,x.tooltip.offset.y);p.lineTo(a,x.tooltip.offset.y);p.stroke();p.setLineDash([]);if(d.yAxisLabel){let s=calTooltipYAxisData(x.tooltip.offset.y,x.series,x,f,t);let l=x.chartData.yAxisData.yAxisWidth;let h=x.area[3];let c=x.width-x.area[1];for(let n=0;n<s.length;n++){p.setFontSize(f.fontSize);let t=measureText(s[n],f.fontSize,p);let e,i,a;if(l[n].position=="left"){e=h-l[n].width;i=Math.max(e,e+t+f.toolTipPadding*2)}else{e=c;i=Math.max(e+l[n].width,e+t+f.toolTipPadding*2)}a=i-e;let r=e+(a-t)/2;let o=x.tooltip.offset.y;p.beginPath();p.setFillStyle(hexToRgb(d.labelBgColor||f.toolTipBackground,d.labelBgOpacity||f.toolTipOpacity));p.setStrokeStyle(d.labelBgColor||f.toolTipBackground);p.setLineWidth(1*x.pix);p.rect(e,o-.5*f.fontSize-f.toolTipPadding,a,f.fontSize+2*f.toolTipPadding);p.closePath();p.stroke();p.fill();p.beginPath();p.setFontSize(f.fontSize);p.setFillStyle(d.labelFontColor||x.fontColor);p.fillText(s[n],r,o+.5*f.fontSize);p.closePath();p.stroke();if(l[n].position=="left"){h-=l[n].width+x.yAxis.padding*x.pix}else{c+=l[n].width+x.yAxis.padding*x.pix}}}}function drawToolTipSplitArea(t,e,i,a,r){var o=assign({},{activeBgColor:"#000000",activeBgOpacity:.08,activeWidth:r},e.extra.column);o.activeWidth=o.activeWidth>r?r:o.activeWidth;var n=e.area[0];var s=e.height-e.area[2];a.beginPath();a.setFillStyle(hexToRgb(o.activeBgColor,o.activeBgOpacity));a.rect(t-o.activeWidth/2,n,o.activeWidth,s-n);a.closePath();a.fill();a.setFillStyle("#FFFFFF")}function drawToolTip(t,r,e,o,n,c,x){var s=assign({},{showBox:true,showArrow:true,showCategory:false,bgColor:"#000000",bgOpacity:.7,borderColor:"#000000",borderWidth:0,borderRadius:0,borderOpacity:.7,fontColor:"#FFFFFF",splitLine:true},e.extra.tooltip);if(s.showCategory==true&&e.categories){t.unshift({text:e.categories[e.tooltip.index],color:null})}var f=4*e.pix;var p=5*e.pix;var l=s.showArrow?8*e.pix:0;var d=false;if(e.type=="line"||e.type=="mount"||e.type=="area"||e.type=="candle"||e.type=="mix"){if(s.splitLine==true){drawToolTipSplitLine(e.tooltip.offset.x,e,o,n)}}r=assign({x:0,y:0},r);r.y-=8*e.pix;var u=t.map(function(t){return measureText(t.text,o.fontSize,n)});var h=f+p+4*o.toolTipPadding+Math.max.apply(null,u);var i=2*o.toolTipPadding+t.length*o.toolTipLineHeight;if(s.showBox==false){return}if(r.x-Math.abs(e._scrollDistance_||0)+l+h>e.width){d=true}if(i+r.y>e.height){r.y=e.height-i}n.beginPath();n.setFillStyle(hexToRgb(s.bgColor||o.toolTipBackground,s.bgOpacity||o.toolTipOpacity));n.setLineWidth(s.borderWidth*e.pix);n.setStrokeStyle(hexToRgb(s.borderColor,s.borderOpacity));var a=s.borderRadius;if(d){if(s.showArrow){n.moveTo(r.x,r.y+10*e.pix);n.lineTo(r.x-l,r.y+10*e.pix+5*e.pix)}n.arc(r.x-l-a,r.y+i-a,a,0,Math.PI/2,false);n.arc(r.x-l-Math.round(h)+a,r.y+i-a,a,Math.PI/2,Math.PI,false);n.arc(r.x-l-Math.round(h)+a,r.y+a,a,-Math.PI,-Math.PI/2,false);n.arc(r.x-l-a,r.y+a,a,-Math.PI/2,0,false);if(s.showArrow){n.lineTo(r.x-l,r.y+10*e.pix-5*e.pix);n.lineTo(r.x,r.y+10*e.pix)}}else{if(s.showArrow){n.moveTo(r.x,r.y+10*e.pix);n.lineTo(r.x+l,r.y+10*e.pix-5*e.pix)}n.arc(r.x+l+a,r.y+a,a,-Math.PI,-Math.PI/2,false);n.arc(r.x+l+Math.round(h)-a,r.y+a,a,-Math.PI/2,0,false);n.arc(r.x+l+Math.round(h)-a,r.y+i-a,a,0,Math.PI/2,false);n.arc(r.x+l+a,r.y+i-a,a,Math.PI/2,Math.PI,false);if(s.showArrow){n.lineTo(r.x+l,r.y+10*e.pix+5*e.pix);n.lineTo(r.x,r.y+10*e.pix)}}n.closePath();n.fill();if(s.borderWidth>0){n.stroke()}t.forEach(function(t,e){if(t.color!==null){n.beginPath();n.setFillStyle(t.color);var i=r.x+l+2*o.toolTipPadding;var a=r.y+(o.toolTipLineHeight-o.fontSize)/2+o.toolTipLineHeight*e+o.toolTipPadding+1;if(d){i=r.x-h-l+2*o.toolTipPadding}n.fillRect(i,a,f,o.fontSize);n.closePath()}});t.forEach(function(t,e){var i=r.x+l+2*o.toolTipPadding+f+p;if(d){i=r.x-h-l+2*o.toolTipPadding+ +f+p}var a=r.y+(o.toolTipLineHeight-o.fontSize)/2+o.toolTipLineHeight*e+o.toolTipPadding;n.beginPath();n.setFontSize(o.fontSize);n.setFillStyle(s.fontColor);n.fillText(t.text,i,a+o.fontSize);n.closePath();n.stroke()})}function drawColumnDataPoints(y,m,v,A){let T=arguments.length>4&&arguments[4]!==undefined?arguments[4]:1;let t=m.chartData.xAxisData,b=t.xAxisPoints,w=t.eachSpacing;let S=assign({},{type:"group",width:w/2,meterBorder:4,meterFillColor:"#FFFFFF",barBorderCircle:false,barBorderRadius:[],seriesGap:2,linearType:"none",linearOpacity:1,customColor:[],colorStop:0},m.extra.column);let C=[];A.save();let P=-2;let D=b.length+2;if(m._scrollDistance_&&m._scrollDistance_!==0&&m.enableScroll===true){A.translate(m._scrollDistance_,0);P=Math.floor(-m._scrollDistance_/w)-2;D=P+m.xAxis.itemCount+4}if(m.tooltip&&m.tooltip.textList&&m.tooltip.textList.length&&T===1){drawToolTipSplitArea(m.tooltip.offset.x,m,v,A,w)}S.customColor=fillCustomColor(S.linearType,S.customColor,y,v);y.forEach(function(i,a){let t,o,f;t=[].concat(m.chartData.yAxisData.ranges[i.index]);o=t.pop();f=t.shift();var p=i.data;switch(S.type){case"group":var r=getDataPoints(p,o,f,b,w,m,v,T);var d=getStackDataPoints(p,o,f,b,w,m,v,a,y,T);C.push(d);r=fixColumeData(r,w,y.length,a,v,m);for(let t=0;t<r.length;t++){let o=r[t];if(o!==null&&t>P&&t<D){var n=o.x-o.width/2;var s=m.height-o.y-m.area[2];A.beginPath();var l=o.color||i.color;var u=o.color||i.color;if(S.linearType!=="none"){var e=A.createLinearGradient(n,o.y,n,m.height-m.area[2]);if(S.linearType=="opacity"){e.addColorStop(0,hexToRgb(l,S.linearOpacity));e.addColorStop(1,hexToRgb(l,1))}else{e.addColorStop(0,hexToRgb(S.customColor[i.linearIndex],S.linearOpacity));e.addColorStop(S.colorStop,hexToRgb(S.customColor[i.linearIndex],S.linearOpacity));e.addColorStop(1,hexToRgb(l,1))}l=e}if(S.barBorderRadius&&S.barBorderRadius.length===4||S.barBorderCircle===true){const h=n;const c=o.y;const x=o.width;const s=m.height-m.area[2]-o.y;if(S.barBorderCircle){S.barBorderRadius=[x/2,x/2,0,0]}let[t,e,i,a]=S.barBorderRadius;let r=Math.min(x/2,s/2);t=t>r?r:t;e=e>r?r:e;i=i>r?r:i;a=a>r?r:a;t=t<0?0:t;e=e<0?0:e;i=i<0?0:i;a=a<0?0:a;A.arc(h+t,c+t,t,-Math.PI,-Math.PI/2);A.arc(h+x-e,c+e,e,-Math.PI/2,0);A.arc(h+x-i,c+s-i,i,0,Math.PI/2);A.arc(h+a,c+s-a,a,Math.PI/2,Math.PI)}else{A.moveTo(n,o.y);A.lineTo(n+o.width,o.y);A.lineTo(n+o.width,m.height-m.area[2]);A.lineTo(n,m.height-m.area[2]);A.lineTo(n,o.y);A.setLineWidth(1);A.setStrokeStyle(u)}A.setFillStyle(l);A.closePath();A.fill()}};break;case"stack":var r=getStackDataPoints(p,o,f,b,w,m,v,a,y,T);C.push(r);r=fixColumeStackData(r,w,y.length,a,v,m,y);for(let e=0;e<r.length;e++){let t=r[e];if(t!==null&&e>P&&e<D){A.beginPath();var l=t.color||i.color;var n=t.x-t.width/2+1;var s=m.height-t.y-m.area[2];var g=m.height-t.y0-m.area[2];if(a>0){s-=g}A.setFillStyle(l);A.moveTo(n,t.y);A.fillRect(n,t.y,t.width,s);A.closePath();A.fill()}};break;case"meter":var r=getDataPoints(p,o,f,b,w,m,v,T);C.push(r);r=fixColumeMeterData(r,w,y.length,a,v,m,S.meterBorder);for(let t=0;t<r.length;t++){let o=r[t];if(o!==null&&t>P&&t<D){A.beginPath();if(a==0&&S.meterBorder>0){A.setStrokeStyle(i.color);A.setLineWidth(S.meterBorder*m.pix)}if(a==0){A.setFillStyle(S.meterFillColor)}else{A.setFillStyle(o.color||i.color)}var n=o.x-o.width/2;var s=m.height-o.y-m.area[2];if(S.barBorderRadius&&S.barBorderRadius.length===4||S.barBorderCircle===true){const h=n;const c=o.y;const x=o.width;const s=m.height-m.area[2]-o.y;if(S.barBorderCircle){S.barBorderRadius=[x/2,x/2,0,0]}let[t,e,i,a]=S.barBorderRadius;let r=Math.min(x/2,s/2);t=t>r?r:t;e=e>r?r:e;i=i>r?r:i;a=a>r?r:a;t=t<0?0:t;e=e<0?0:e;i=i<0?0:i;a=a<0?0:a;A.arc(h+t,c+t,t,-Math.PI,-Math.PI/2);A.arc(h+x-e,c+e,e,-Math.PI/2,0);A.arc(h+x-i,c+s-i,i,0,Math.PI/2);A.arc(h+a,c+s-a,a,Math.PI/2,Math.PI);A.fill()}else{A.moveTo(n,o.y);A.lineTo(n+o.width,o.y);A.lineTo(n+o.width,m.height-m.area[2]);A.lineTo(n,m.height-m.area[2]);A.lineTo(n,o.y);A.fill()}if(a==0&&S.meterBorder>0){A.closePath();A.stroke()}}}break}});if(m.dataLabel!==false&&T===1){y.forEach(function(t,e){let i,a,r;i=[].concat(m.chartData.yAxisData.ranges[t.index]);a=i.pop();r=i.shift();var o=t.data;switch(S.type){case"group":var n=getDataPoints(o,a,r,b,w,m,v,T);n=fixColumeData(n,w,y.length,e,v,m);drawPointText(n,t,v,A,m);break;case"stack":var n=getStackDataPoints(o,a,r,b,w,m,v,e,y,T);drawPointText(n,t,v,A,m);break;case"meter":var n=getDataPoints(o,a,r,b,w,m,v,T);drawPointText(n,t,v,A,m);break}})}A.restore();return{xAxisPoints:b,calPoints:C,eachSpacing:w}}function drawLineDataPoints(t,l,h,c){var x=arguments.length>4&&arguments[4]!==undefined?arguments[4]:1;var f=assign({},{type:"straight",width:2},l.extra.line);f.width*=l.pix;let e=l.chartData.xAxisData,p=e.xAxisPoints,d=e.eachSpacing;var y=[];c.save();let u=0;let g=l.width+d;if(l._scrollDistance_&&l._scrollDistance_!==0&&l.enableScroll===true){c.translate(l._scrollDistance_,0);u=-l._scrollDistance_-d*2+l.area[3];g=u+(l.xAxis.itemCount+4)*d}t.forEach(function(e,t){let i,a,r;i=[].concat(l.chartData.yAxisData.ranges[e.index]);a=i.pop();r=i.shift();var o=e.data;var n=getDataPoints(o,a,r,p,d,l,h,x);y.push(n);var s=splitPoints(n,e);if(e.lineType=="dash"){let t=e.dashLength?e.dashLength:8;t*=l.pix;c.setLineDash([t,t])}c.beginPath();c.setStrokeStyle(e.color);c.setLineWidth(f.width);s.forEach(function(a,t){if(a.length===1){c.moveTo(a[0].x,a[0].y);c.arc(a[0].x,a[0].y,1,0,2*Math.PI)}else{c.moveTo(a[0].x,a[0].y);let i=0;if(f.type==="curve"){for(let e=0;e<a.length;e++){let t=a[e];if(i==0&&t.x>u){c.moveTo(t.x,t.y);i=1}if(e>0&&t.x>u&&t.x<g){var r=createCurveControlPoints(a,e-1);c.bezierCurveTo(r.ctrA.x,r.ctrA.y,r.ctrB.x,r.ctrB.y,t.x,t.y)}}}if(f.type==="straight"){for(let e=0;e<a.length;e++){let t=a[e];if(i==0&&t.x>u){c.moveTo(t.x,t.y);i=1}if(e>0&&t.x>u&&t.x<g){c.lineTo(t.x,t.y)}}}if(f.type==="step"){for(let e=0;e<a.length;e++){let t=a[e];if(i==0&&t.x>u){c.moveTo(t.x,t.y);i=1}if(e>0&&t.x>u&&t.x<g){c.lineTo(t.x,a[e-1].y);c.lineTo(t.x,t.y)}}}c.moveTo(a[0].x,a[0].y)}});c.stroke();c.setLineDash([]);if(l.dataPointShape!==false){drawPointShape(n,e.color,e.pointShape,c,l)}});if(l.dataLabel!==false&&x===1){t.forEach(function(t,e){let i,a,r;i=[].concat(l.chartData.yAxisData.ranges[t.index]);a=i.pop();r=i.shift();var o=t.data;var n=getDataPoints(o,a,r,p,d,l,h,x);drawPointText(n,t,h,c,l)})}c.restore();return{xAxisPoints:p,calPoints:y,eachSpacing:d}}function drawToolTipBridge(t,e,i,a,r,o){var n=t.extra.tooltip||{};if(n.horizentalLine&&t.tooltip&&a===1&&(t.type=="line"||t.type=="area"||t.type=="column"||t.type=="mount"||t.type=="candle"||t.type=="mix")){drawToolTipHorizentalLine(t,e,i,r,o)}i.save();if(t._scrollDistance_&&t._scrollDistance_!==0&&t.enableScroll===true){i.translate(t._scrollDistance_,0)}if(t.tooltip&&t.tooltip.textList&&t.tooltip.textList.length&&a===1){drawToolTip(t.tooltip.textList,t.tooltip.offset,t,e,i,r,o)}i.restore()}function drawXAxis(r,s,l,h){let t=s.chartData.xAxisData,c=t.xAxisPoints,e=t.startX,i=t.endX,x=t.eachSpacing;var d="center";if(s.type=="bar"||s.type=="line"||s.type=="area"||s.type=="scatter"||s.type=="bubble"){d=s.xAxis.boundaryGap}var f=s.height-s.area[2];var a=s.area[0];if(s.enableScroll&&s.xAxis.scrollShow){var o=s.height-s.area[2]+l.xAxisHeight;var n=i-e;var u=x*(c.length-1);if(s.type=="mount"&&s.extra&&s.extra.mount&&s.extra.mount.widthRatio&&s.extra.mount.widthRatio>1){if(s.extra.mount.widthRatio>2)s.extra.mount.widthRatio=2;u+=(s.extra.mount.widthRatio-1)*x}var g=n*n/u;var y=0;if(s._scrollDistance_){y=-s._scrollDistance_*n/u}h.beginPath();h.setLineCap("round");h.setLineWidth(6*s.pix);h.setStrokeStyle(s.xAxis.scrollBackgroundColor||"#EFEBEF");h.moveTo(e,o);h.lineTo(i,o);h.stroke();h.closePath();h.beginPath();h.setLineCap("round");h.setLineWidth(6*s.pix);h.setStrokeStyle(s.xAxis.scrollColor||"#A6A6A6");h.moveTo(e+y,o);h.lineTo(e+y+g,o);h.stroke();h.closePath();h.setLineCap("butt")}h.save();if(s._scrollDistance_&&s._scrollDistance_!==0){h.translate(s._scrollDistance_,0)}if(s.xAxis.calibration===true){h.setStrokeStyle(s.xAxis.gridColor||"#cccccc");h.setLineCap("butt");h.setLineWidth(1*s.pix);c.forEach(function(t,e){if(e>0){h.beginPath();h.moveTo(t-x/2,f);h.lineTo(t-x/2,f+3*s.pix);h.closePath();h.stroke()}})}if(s.xAxis.disableGrid!==true){h.setStrokeStyle(s.xAxis.gridColor||"#cccccc");h.setLineCap("butt");h.setLineWidth(1*s.pix);if(s.xAxis.gridType=="dash"){h.setLineDash([s.xAxis.dashLength*s.pix,s.xAxis.dashLength*s.pix])}s.xAxis.gridEval=s.xAxis.gridEval||1;c.forEach(function(t,e){if(e%s.xAxis.gridEval==0){h.beginPath();h.moveTo(t,f);h.lineTo(t,a);h.stroke()}});h.setLineDash([])}if(s.xAxis.disabled!==true){let t=r.length;if(s.xAxis.labelCount){if(s.xAxis.itemCount){t=Math.ceil(r.length/s.xAxis.itemCount*s.xAxis.labelCount)}else{t=s.xAxis.labelCount}t-=1}let e=Math.ceil(r.length/t);let i=[];let a=r.length;for(let t=0;t<a;t++){if(t%e!==0){i.push("")}else{i.push(r[t])}}i[a-1]=r[a-1];var p=s.xAxis.fontSize*s.pix||l.fontSize;if(l._xAxisTextAngle_===0){i.forEach(function(t,e){var i=s.xAxis.formatter?s.xAxis.formatter(t,e,s):t;var a=-measureText(String(i),p,h)/2;if(d=="center"){a+=x/2}var r=0;if(s.xAxis.scrollShow){r=6*s.pix}h.beginPath();h.setFontSize(p);h.setFillStyle(s.xAxis.fontColor||s.fontColor);h.fillText(String(i),c[e]+a,f+p+(l.xAxisHeight-r-p)/2);h.closePath();h.stroke()})}else{i.forEach(function(t,e){var i=s.xAxis.formatter?s.xAxis.formatter(t):t;h.save();h.beginPath();h.setFontSize(p);h.setFillStyle(s.xAxis.fontColor||s.fontColor);var a=measureText(String(i),p,h);var r=c[e];if(d=="center"){r=c[e]+x/2}var o=0;if(s.xAxis.scrollShow){o=6*s.pix}var n=f+6*s.pix+p-p*Math.abs(Math.sin(l._xAxisTextAngle_));if(s.xAxis.rotateAngle<0){r-=p/2;a=0}else{r+=p/2;a=-a}h.translate(r,n);h.rotate(-1*l._xAxisTextAngle_);h.fillText(String(i),a,0);h.closePath();h.stroke();h.restore()})}}h.restore();if(s.xAxis.axisLine){h.beginPath();h.setStrokeStyle(s.xAxis.axisLineColor);h.setLineWidth(1*s.pix);h.moveTo(e,s.height-s.area[2]);h.lineTo(i,s.height-s.area[2]);h.stroke()}}function drawYAxisGrid(c,e,x,i){if(e.yAxis.disableGrid===true){return}let t=e.height-e.area[0]-e.area[2];let a=t/e.yAxis.splitNumber;let r=e.area[3];let o=e.chartData.xAxisData.xAxisPoints,n=e.chartData.xAxisData.eachSpacing;let s=n*(o.length-1);if(e.type=="mount"&&e.extra&&e.extra.mount&&e.extra.mount.widthRatio&&e.extra.mount.widthRatio>1){if(e.extra.mount.widthRatio>2)e.extra.mount.widthRatio=2;s+=(e.extra.mount.widthRatio-1)*n}let f=r+s;let l=[];let h=1;if(e.xAxis.axisLine===false){h=0}for(let t=h;t<e.yAxis.splitNumber+1;t++){l.push(e.height-e.area[2]-a*t)}i.save();if(e._scrollDistance_&&e._scrollDistance_!==0){i.translate(e._scrollDistance_,0)}if(e.yAxis.gridType=="dash"){i.setLineDash([e.yAxis.dashLength*e.pix,e.yAxis.dashLength*e.pix])}i.setStrokeStyle(e.yAxis.gridColor);i.setLineWidth(1*e.pix);l.forEach(function(t,e){i.beginPath();i.moveTo(r,t);i.lineTo(f,t);i.stroke()});i.setLineDash([]);i.restore()}function drawYAxis(e,h,i,c){if(h.yAxis.disabled===true){return}var a=h.height-h.area[0]-h.area[2];var r=a/h.yAxis.splitNumber;var o=h.area[3];var n=h.width-h.area[1];var s=h.height-h.area[2];var t=s+i.xAxisHeight;if(h.xAxis.scrollShow){t-=3*h.pix}if(h.xAxis.rotateLabel){t=h.height-h.area[2]+h.fontSize*h.pix/2}c.beginPath();c.setFillStyle(h.background);if(h.enableScroll==true&&h.xAxis.scrollPosition&&h.xAxis.scrollPosition!=="left"){c.fillRect(0,0,o,t)}if(h.enableScroll==true&&h.xAxis.scrollPosition&&h.xAxis.scrollPosition!=="right"){c.fillRect(n,0,h.width,t)}c.closePath();c.stroke();let x=h.area[3];let f=h.width-h.area[1];let p=h.area[3]+(h.width-h.area[1]-h.area[3])/2;if(h.yAxis.data){for(let e=0;e<h.yAxis.data.length;e++){let l=h.yAxis.data[e];var d=[];if(l.type==="categories"){for(let t=0;t<=l.categories.length;t++){d.push(h.area[0]+a/l.categories.length/2+a/l.categories.length*t)}}else{for(let t=0;t<=h.yAxis.splitNumber;t++){d.push(h.area[0]+r*t)}}if(l.disabled!==true){let t=h.chartData.yAxisData.rangesFormat[e];let o=l.fontSize?l.fontSize*h.pix:i.fontSize;let n=h.chartData.yAxisData.yAxisWidth[e];let s=l.textAlign||"right";t.forEach(function(t,e){var i=d[e];c.beginPath();c.setFontSize(o);c.setLineWidth(1*h.pix);c.setStrokeStyle(l.axisLineColor||"#cccccc");c.setFillStyle(l.fontColor||h.fontColor);let a=0;let r=4*h.pix;if(n.position=="left"){if(l.calibration==true){c.moveTo(x,i);c.lineTo(x-3*h.pix,i);r+=3*h.pix}switch(s){case"left":c.setTextAlign("left");a=x-n.width;break;case"right":c.setTextAlign("right");a=x-r;break;default:c.setTextAlign("center");a=x-n.width/2}c.fillText(String(t),a,i+o/2-3*h.pix)}else if(n.position=="right"){if(l.calibration==true){c.moveTo(f,i);c.lineTo(f+3*h.pix,i);r+=3*h.pix}switch(s){case"left":c.setTextAlign("left");a=f+r;break;case"right":c.setTextAlign("right");a=f+n.width;break;default:c.setTextAlign("center");a=f+n.width/2}c.fillText(String(t),a,i+o/2-3*h.pix)}else if(n.position=="center"){if(l.calibration==true){c.moveTo(p,i);c.lineTo(p-3*h.pix,i);r+=3*h.pix}switch(s){case"left":c.setTextAlign("left");a=p-n.width;break;case"right":c.setTextAlign("right");a=p-r;break;default:c.setTextAlign("center");a=p-n.width/2}c.fillText(String(t),a,i+o/2-3*h.pix)}c.closePath();c.stroke();c.setTextAlign("left")});if(l.axisLine!==false){c.beginPath();c.setStrokeStyle(l.axisLineColor||"#cccccc");c.setLineWidth(1*h.pix);if(n.position=="left"){c.moveTo(x,h.height-h.area[2]);c.lineTo(x,h.area[0])}else if(n.position=="right"){c.moveTo(f,h.height-h.area[2]);c.lineTo(f,h.area[0])}else if(n.position=="center"){c.moveTo(p,h.height-h.area[2]);c.lineTo(p,h.area[0])}c.stroke()}if(h.yAxis.showTitle){let t=l.titleFontSize*h.pix||i.fontSize;let e=l.title;c.beginPath();c.setFontSize(t);c.setFillStyle(l.titleFontColor||h.fontColor);if(n.position=="left"){c.fillText(e,x-measureText(e,t,c)/2+(l.titleOffsetX||0),h.area[0]-(10-(l.titleOffsetY||0))*h.pix)}else if(n.position=="right"){c.fillText(e,f-measureText(e,t,c)/2+(l.titleOffsetX||0),h.area[0]-(10-(l.titleOffsetY||0))*h.pix)}else if(n.position=="center"){c.fillText(e,p-measureText(e,t,c)/2+(l.titleOffsetX||0),h.area[0]-(10-(l.titleOffsetY||0))*h.pix)}c.closePath();c.stroke()}if(n.position=="left"){x-=n.width+h.yAxis.padding*h.pix}else{f+=n.width+h.yAxis.padding*h.pix}}}}}function drawLegend(t,s,y,l,e){if(s.legend.show===false){return}let h=e.legendData;let i=h.points;let c=h.area;let x=s.legend.padding*s.pix;let f=s.legend.fontSize*s.pix;let p=15*s.pix;let d=5*s.pix;let u=s.legend.itemGap*s.pix;let g=Math.max(s.legend.lineHeight*s.pix,f);l.beginPath();l.setLineWidth(s.legend.borderWidth*s.pix);l.setStrokeStyle(s.legend.borderColor);l.setFillStyle(s.legend.backgroundColor);l.moveTo(c.start.x,c.start.y);l.rect(c.start.x,c.start.y,c.width,c.height);l.closePath();l.fill();l.stroke();i.forEach(function(a,t){let e=0;let i=0;e=h.widthArr[t];i=h.heightArr[t];let r=0;let o=0;if(s.legend.position=="top"||s.legend.position=="bottom"){switch(s.legend.float){case"left":r=c.start.x+x;break;case"right":r=c.start.x+c.width-e;break;default:r=c.start.x+(c.width-e)/2}o=c.start.y+x+t*g}else{if(t==0){e=0}else{e=h.widthArr[t-1]}r=c.start.x+x+e;o=c.start.y+x+(c.height-i)/2}l.setFontSize(y.fontSize);for(let i=0;i<a.length;i++){let t=a[i];t.area=[0,0,0,0];t.area[0]=r;t.area[1]=o;t.area[3]=o+g;l.beginPath();l.setLineWidth(1*s.pix);l.setStrokeStyle(t.show?t.color:s.legend.hiddenColor);l.setFillStyle(t.show?t.color:s.legend.hiddenColor);switch(t.legendShape){case"line":l.moveTo(r,o+.5*g-2*s.pix);l.fillRect(r,o+.5*g-2*s.pix,15*s.pix,4*s.pix);break;case"triangle":l.moveTo(r+7.5*s.pix,o+.5*g-5*s.pix);l.lineTo(r+2.5*s.pix,o+.5*g+5*s.pix);l.lineTo(r+12.5*s.pix,o+.5*g+5*s.pix);l.lineTo(r+7.5*s.pix,o+.5*g-5*s.pix);break;case"diamond":l.moveTo(r+7.5*s.pix,o+.5*g-5*s.pix);l.lineTo(r+2.5*s.pix,o+.5*g);l.lineTo(r+7.5*s.pix,o+.5*g+5*s.pix);l.lineTo(r+12.5*s.pix,o+.5*g);l.lineTo(r+7.5*s.pix,o+.5*g-5*s.pix);break;case"circle":l.moveTo(r+7.5*s.pix,o+.5*g);l.arc(r+7.5*s.pix,o+.5*g,5*s.pix,0,2*Math.PI);break;case"rect":l.moveTo(r,o+.5*g-5*s.pix);l.fillRect(r,o+.5*g-5*s.pix,15*s.pix,10*s.pix);break;case"square":l.moveTo(r+5*s.pix,o+.5*g-5*s.pix);l.fillRect(r+5*s.pix,o+.5*g-5*s.pix,10*s.pix,10*s.pix);break;case"none":break;default:l.moveTo(r,o+.5*g-5*s.pix);l.fillRect(r,o+.5*g-5*s.pix,15*s.pix,10*s.pix)}l.closePath();l.fill();l.stroke();r+=p+d;let e=.5*g+.5*f-2;const n=t.legendText?t.legendText:t.name;l.beginPath();l.setFontSize(f);l.setFillStyle(t.show?s.legend.fontColor:s.legend.hiddenColor);l.fillText(n,r,o+e);l.closePath();l.stroke();if(s.legend.position=="top"||s.legend.position=="bottom"){r+=measureText(n,f,l)+u;t.area[2]=r}else{t.area[2]=r+measureText(n,f,l)+u;r-=p+d;o+=g}}})}function drawArcbarDataPoints(i,a,t,r){var e=arguments.length>4&&arguments[4]!==undefined?arguments[4]:1;var o=assign({},{startAngle:.75,endAngle:.25,type:"default",lineCap:"round",width:12,gap:2,linearType:"none",customColor:[]},a.extra.arcbar);i=getArcbarDataPoints(i,o,e);var n;if(o.centerX||o.centerY){n={x:o.centerX?o.centerX:a.width/2,y:o.centerY?o.centerY:a.height/2}}else{n={x:a.width/2,y:a.height/2}}var s;if(o.radius){s=o.radius}else{s=Math.min(n.x,n.y);s-=5*a.pix;s-=o.width/2}s=s<10?10:s;o.customColor=fillCustomColor(o.linearType,o.customColor,i,t);for(let e=0;e<i.length;e++){let t=i[e];r.setLineWidth(o.width*a.pix);r.setStrokeStyle(o.backgroundColor||"#E9E9E9");r.setLineCap(o.lineCap);r.beginPath();if(o.type=="default"){r.arc(n.x,n.y,s-(o.width*a.pix+o.gap*a.pix)*e,o.startAngle*Math.PI,o.endAngle*Math.PI,false)}else{r.arc(n.x,n.y,s-(o.width*a.pix+o.gap*a.pix)*e,0,2*Math.PI,false)}r.stroke();var l=t.color;if(o.linearType=="custom"){var h=r.createLinearGradient(n.x-s,n.y,n.x+s,n.y);h.addColorStop(1,hexToRgb(o.customColor[t.linearIndex],1));h.addColorStop(0,hexToRgb(t.color,1));l=h}r.setLineWidth(o.width*a.pix);r.setStrokeStyle(l);r.setLineCap(o.lineCap);r.beginPath();r.arc(n.x,n.y,s-(o.width*a.pix+o.gap*a.pix)*e,o.startAngle*Math.PI,t._proportion_*Math.PI,false);r.stroke()}drawRingTitle(a,t,r,n);return{center:n,radius:s,series:i}}function drawCanvas(t,e){e.draw()}var Timing={easeIn:function t(e){return Math.pow(e,3)},easeOut:function t(e){return Math.pow(e-1,3)+1},easeInOut:function t(e){if((e/=.5)<1){return.5*Math.pow(e,3)}else{return.5*(Math.pow(e-2,3)+2)}},linear:function t(e){return e}};function Animation(r){this.isStop=false;r.duration=typeof r.duration==="undefined"?1e3:r.duration;r.timing=r.timing||"easeInOut";var o=17;function t(){if(typeof setTimeout!=="undefined"){return function(e,t){setTimeout(function(){var t=+new Date;e(t)},t)}}else if(typeof requestAnimationFrame!=="undefined"){return requestAnimationFrame}else{return function(t){t(null)}}}var n=t();var s=null;var l=function t(e){if(e===null||this.isStop===true){r.onProcess&&r.onProcess(1);r.onAnimationFinish&&r.onAnimationFinish();return}if(s===null){s=e}if(e-s<r.duration){var i=(e-s)/r.duration;var a=Timing[r.timing];i=a(i);r.onProcess&&r.onProcess(i);n(l,o)}else{r.onProcess&&r.onProcess(1);r.onAnimationFinish&&r.onAnimationFinish()}};l=l.bind(this);n(l,o)}Animation.prototype.stop=function(){this.isStop=true};function drawCharts(t,s,n,l){var h=this;var c=s.series;if(t==="pie"||t==="ring"||t==="mount"||t==="rose"||t==="funnel"){c=fixPieSeries(c,s,n)}var x=s.categories;if(t==="mount"){x=[];for(let t=0;t<c.length;t++){if(c[t].show!==false)x.push(c[t].name)}s.categories=x}c=fillSeries(c,s,n);var e=s.animation?s.duration:0;h.animationInstance&&h.animationInstance.stop();var i=null;if(t=="candle"){let t=assign({},s.extra.candle.average);if(t.show){i=calCandleMA(t.day,t.name,t.color,c[0].data);i=fillSeries(i,s,n);s.seriesMA=i}else if(s.seriesMA){i=s.seriesMA=fillSeries(s.seriesMA,s,n)}else{i=c}}else{i=c}s._series_=c=filterSeries(c);s.area=new Array(4);for(let t=0;t<4;t++){s.area[t]=s.padding[t]*s.pix}var r=calLegendData(i,s,n,s.chartData,l),o=r.area.wholeHeight,f=r.area.wholeWidth;switch(s.legend.position){case"top":s.area[0]+=o;break;case"bottom":s.area[2]+=o;break;case"left":s.area[3]+=f;break;case"right":s.area[1]+=f;break}let p={},a=0;if(s.type==="line"||s.type==="column"||s.type==="mount"||s.type==="area"||s.type==="mix"||s.type==="candle"||s.type==="scatter"||s.type==="bubble"||s.type==="bar"){p=calYAxisData(c,s,n,l);a=p.yAxisWidth;if(s.yAxis.showTitle){let e=0;for(let t=0;t<s.yAxis.data.length;t++){e=Math.max(e,s.yAxis.data[t].titleFontSize?s.yAxis.data[t].titleFontSize*s.pix:n.fontSize)}s.area[0]+=e}let e=0,i=0;for(let t=0;t<a.length;t++){if(a[t].position=="left"){if(i>0){s.area[3]+=a[t].width+s.yAxis.padding*s.pix}else{s.area[3]+=a[t].width}i+=1}else if(a[t].position=="right"){if(e>0){s.area[1]+=a[t].width+s.yAxis.padding*s.pix}else{s.area[1]+=a[t].width}e+=1}}}else{n.yAxisWidth=a}s.chartData.yAxisData=p;if(s.categories&&s.categories.length&&s.type!=="radar"&&s.type!=="gauge"&&s.type!=="bar"){s.chartData.xAxisData=getXAxisPoints(s.categories,s,n);let t=calCategoriesData(s.categories,s,n,s.chartData.xAxisData.eachSpacing,l),e=t.xAxisHeight,i=t.angle;n.xAxisHeight=e;n._xAxisTextAngle_=i;s.area[2]+=e;s.chartData.categoriesData=t}else{if(s.type==="line"||s.type==="area"||s.type==="scatter"||s.type==="bubble"||s.type==="bar"){s.chartData.xAxisData=calXAxisData(c,s,n,l);x=s.chartData.xAxisData.rangesFormat;let t=calCategoriesData(x,s,n,s.chartData.xAxisData.eachSpacing,l),e=t.xAxisHeight,i=t.angle;n.xAxisHeight=e;n._xAxisTextAngle_=i;s.area[2]+=e;s.chartData.categoriesData=t}else{s.chartData.xAxisData={xAxisPoints:[]}}}if(s.enableScroll&&s.xAxis.scrollAlign=="right"&&s._scrollDistance_===undefined){let t=0,e=s.chartData.xAxisData.xAxisPoints,i=s.chartData.xAxisData.startX,a=s.chartData.xAxisData.endX,r=s.chartData.xAxisData.eachSpacing;let o=r*(e.length-1);let n=a-i;t=n-o;h.scrollOption.currentOffset=t;h.scrollOption.startTouchX=t;h.scrollOption.distance=0;h.scrollOption.lastMoveTime=0;s._scrollDistance_=t}switch(t){case"line":this.animationInstance=new Animation({timing:s.timing,duration:e,onProcess:function t(e){l.clearRect(0,0,s.width,s.height);if(s.rotate){contextRotate(l,s)}drawYAxisGrid(x,s,n,l);drawXAxis(x,s,n,l);var i=drawLineDataPoints(c,s,n,l,e),a=i.xAxisPoints,r=i.calPoints,o=i.eachSpacing;s.chartData.xAxisPoints=a;s.chartData.calPoints=r;s.chartData.eachSpacing=o;drawYAxis(c,s,n,l);if(s.enableMarkLine!==false&&e===1){drawMarkLine(s,n,l)}drawLegend(s.series,s,n,l,s.chartData);drawToolTipBridge(s,n,l,e,o,a);drawCanvas(s,l)},onAnimationFinish:function t(){h.uevent.trigger("renderComplete")}});break;case"column":this.animationInstance=new Animation({timing:s.timing,duration:e,onProcess:function t(e){l.clearRect(0,0,s.width,s.height);if(s.rotate){contextRotate(l,s)}drawYAxisGrid(x,s,n,l);drawXAxis(x,s,n,l);var i=drawColumnDataPoints(c,s,n,l,e),a=i.xAxisPoints,r=i.calPoints,o=i.eachSpacing;s.chartData.xAxisPoints=a;s.chartData.calPoints=r;s.chartData.eachSpacing=o;drawYAxis(c,s,n,l);if(s.enableMarkLine!==false&&e===1){drawMarkLine(s,n,l)}drawLegend(s.series,s,n,l,s.chartData);drawToolTipBridge(s,n,l,e,o,a);drawCanvas(s,l)},onAnimationFinish:function t(){h.uevent.trigger("renderComplete")}});break;case"arcbar":this.animationInstance=new Animation({timing:s.timing,duration:e,onProcess:function t(e){l.clearRect(0,0,s.width,s.height);if(s.rotate){contextRotate(l,s)}s.chartData.arcbarData=drawArcbarDataPoints(c,s,n,l,e);drawCanvas(s,l)},onAnimationFinish:function t(){h.uevent.trigger("renderComplete")}});break}}function uChartsEvent(){this.events={}}uChartsEvent.prototype.addEventListener=function(t,e){this.events[t]=this.events[t]||[];this.events[t].push(e)};uChartsEvent.prototype.delEventListener=function(t){this.events[t]=[]};uChartsEvent.prototype.trigger=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++){e[i]=arguments[i]}var a=e[0];var r=e.slice(1);if(!!this.events[a]){this.events[a].forEach(function(t){try{t.apply(null,r)}catch(t){}})}};var uCharts=function t(i){i.pix=i.pixelRatio?i.pixelRatio:1;i.fontSize=i.fontSize?i.fontSize:13;i.fontColor=i.fontColor?i.fontColor:config.fontColor;if(i.background==""||i.background=="none"){i.background="#FFFFFF"}i.title=assign({},i.title);i.subtitle=assign({},i.subtitle);i.duration=i.duration?i.duration:1e3;i.yAxis=assign({},{data:[],showTitle:false,disabled:false,disableGrid:false,splitNumber:5,gridType:"solid",dashLength:4*i.pix,gridColor:"#cccccc",padding:10,fontColor:"#666666"},i.yAxis);i.xAxis=assign({},{rotateLabel:false,rotateAngle:45,disabled:false,disableGrid:false,splitNumber:5,calibration:false,gridType:"solid",dashLength:4,scrollAlign:"left",boundaryGap:"center",axisLine:true,axisLineColor:"#cccccc"},i.xAxis);i.xAxis.scrollPosition=i.xAxis.scrollAlign;i.legend=assign({},{show:true,position:"bottom",float:"center",backgroundColor:"rgba(0,0,0,0)",borderColor:"rgba(0,0,0,0)",borderWidth:0,padding:5,margin:5,itemGap:10,fontSize:i.fontSize,lineHeight:i.fontSize,fontColor:i.fontColor,formatter:{},hiddenColor:"#CECECE"},i.legend);i.extra=assign({},i.extra);i.rotate=i.rotate?true:false;i.animation=i.animation?true:false;i.rotate=i.rotate?true:false;i.canvas2d=i.canvas2d?true:false;let e=assign({},config);e.color=i.color?i.color:e.color;e.pieChartTextPadding=i.dataLabel===false?0:e.pieChartTextPadding*i.pix;e.rotate=i.rotate;if(i.rotate){let t=i.width;let e=i.height;i.width=e;i.height=t}i.padding=i.padding?i.padding:e.padding;e.yAxisWidth=config.yAxisWidth*i.pix;e.xAxisHeight=config.xAxisHeight*i.pix;if(i.enableScroll&&i.xAxis.scrollShow){e.xAxisHeight+=6*i.pix}e.fontSize=i.fontSize*i.pix;e.titleFontSize=config.titleFontSize*i.pix;e.subtitleFontSize=config.subtitleFontSize*i.pix;e.toolTipPadding=config.toolTipPadding*i.pix;e.toolTipLineHeight=config.toolTipLineHeight*i.pix;if(!i.context){throw new Error("[uCharts] 未获取到context！注意：v2.0版本后，需要自行获取canvas的绘图上下文并传入opts.context！")}this.context=i.context;if(!this.context.setTextAlign){this.context.setStrokeStyle=function(t){return this.strokeStyle=t};this.context.setLineWidth=function(t){return this.lineWidth=t};this.context.setLineCap=function(t){return this.lineCap=t};this.context.setFontSize=function(t){return this.font=t+"px sans-serif"};this.context.setFillStyle=function(t){return this.fillStyle=t};this.context.setTextAlign=function(t){return this.textAlign=t};this.context.draw=function(){}}if(!this.context.setLineDash){this.context.setLineDash=function(t){}}i.chartData={};this.uevent=new uChartsEvent;this.scrollOption={currentOffset:0,startTouchX:0,distance:0,lastMoveTime:0};this.opts=i;this.config=e;drawCharts.call(this,i.type,i,e,this.context)};uCharts.prototype.updateData=function(){let t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.opts=assign({},this.opts,t);this.opts.updateData=true;let c=t.scrollPosition||"current";switch(c){case"current":this.opts._scrollDistance_=this.scrollOption.currentOffset;break;case"left":this.opts._scrollDistance_=0;this.scrollOption={currentOffset:0,startTouchX:0,distance:0,lastMoveTime:0};break;case"right":let t=calYAxisData(this.opts.series,this.opts,this.config,this.context),e=t.yAxisWidth;this.config.yAxisWidth=e;let i=0;let a=getXAxisPoints(this.opts.categories,this.opts,this.config),r=a.xAxisPoints,o=a.startX,n=a.endX,s=a.eachSpacing;let l=s*(r.length-1);let h=n-o;i=h-l;this.scrollOption={currentOffset:i,startTouchX:i,distance:0,lastMoveTime:0};this.opts._scrollDistance_=i;break}drawCharts.call(this,this.opts.type,this.opts,this.config,this.context)};uCharts.prototype.zoom=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.opts.xAxis.itemCount;if(this.opts.enableScroll!==true){console.log("[uCharts] 请启用滚动条后使用");return}let e=Math.round(Math.abs(this.scrollOption.currentOffset)/this.opts.chartData.eachSpacing)+Math.round(this.opts.xAxis.itemCount/2);this.opts.animation=false;this.opts.xAxis.itemCount=t.itemCount;let i=calYAxisData(this.opts.series,this.opts,this.config,this.context),a=i.yAxisWidth;this.config.yAxisWidth=a;let r=0;let o=getXAxisPoints(this.opts.categories,this.opts,this.config),h=o.xAxisPoints,c=o.startX,x=o.endX,n=o.eachSpacing;let f=n*e;let s=x-c;let l=s-n*(h.length-1);r=s/2-f;if(r>0){r=0}if(r<l){r=l}this.scrollOption={currentOffset:r,startTouchX:0,distance:0,lastMoveTime:0};calValidDistance(this,r,this.opts.chartData,this.config,this.opts);this.opts._scrollDistance_=r;drawCharts.call(this,this.opts.type,this.opts,this.config,this.context)};uCharts.prototype.dobuleZoom=function(t){if(this.opts.enableScroll!==true){console.log("[uCharts] 请启用滚动条后使用");return}const i=t.changedTouches;if(i.length<2){return}for(var e=0;e<i.length;e++){i[e].x=i[e].x?i[e].x:i[e].clientX;i[e].y=i[e].y?i[e].y:i[e].clientY}const a=[getTouches(i[0],this.opts,t),getTouches(i[1],this.opts,t)];const c=Math.abs(a[0].x-a[1].x);if(!this.scrollOption.moveCount){let t={changedTouches:[{x:i[0].x,y:this.opts.area[0]/this.opts.pix+2}]};let e={changedTouches:[{x:i[1].x,y:this.opts.area[0]/this.opts.pix+2}]};if(this.opts.rotate){t={changedTouches:[{x:this.opts.height/this.opts.pix-this.opts.area[0]/this.opts.pix-2,y:i[0].y}]};e={changedTouches:[{x:this.opts.height/this.opts.pix-this.opts.area[0]/this.opts.pix-2,y:i[1].y}]}}const l=this.getCurrentDataIndex(t).index;const h=this.getCurrentDataIndex(e).index;const m=Math.abs(l-h);this.scrollOption.moveCount=m;this.scrollOption.moveCurrent1=Math.min(l,h);this.scrollOption.moveCurrent2=Math.max(l,h);return}let x=c/this.scrollOption.moveCount;let r=(this.opts.width-this.opts.area[1]-this.opts.area[3])/x;r=r<=2?2:r;r=r>=this.opts.categories.length?this.opts.categories.length:r;this.opts.animation=false;this.opts.xAxis.itemCount=r;let o=0;let n=getXAxisPoints(this.opts.categories,this.opts,this.config),f=n.xAxisPoints,p=n.startX,d=n.endX,s=n.eachSpacing;let u=s*this.scrollOption.moveCurrent1;let g=d-p;let y=g-s*(f.length-1);o=-u+Math.min(a[0].x,a[1].x)-this.opts.area[3]-s;if(o>0){o=0}if(o<y){o=y}this.scrollOption.currentOffset=o;this.scrollOption.startTouchX=0;this.scrollOption.distance=0;calValidDistance(this,o,this.opts.chartData,this.config,this.opts);this.opts._scrollDistance_=o;drawCharts.call(this,this.opts.type,this.opts,this.config,this.context)};uCharts.prototype.stopAnimation=function(){this.animationInstance&&this.animationInstance.stop()};uCharts.prototype.addEventListener=function(t,e){this.uevent.addEventListener(t,e)};uCharts.prototype.delEventListener=function(t){this.uevent.delEventListener(t)};uCharts.prototype.getCurrentDataIndex=function(e){var i=null;if(e.changedTouches){i=e.changedTouches[0]}else{i=e.mp.changedTouches[0]}if(i){let t=getTouches(i,this.opts,e);if(this.opts.type==="pie"||this.opts.type==="ring"){return findPieChartCurrentIndex({x:t.x,y:t.y},this.opts.chartData.pieData,this.opts)}else if(this.opts.type==="rose"){return findRoseChartCurrentIndex({x:t.x,y:t.y},this.opts.chartData.pieData,this.opts)}else if(this.opts.type==="radar"){return findRadarChartCurrentIndex({x:t.x,y:t.y},this.opts.chartData.radarData,this.opts.categories.length)}else if(this.opts.type==="funnel"){return findFunnelChartCurrentIndex({x:t.x,y:t.y},this.opts.chartData.funnelData)}else if(this.opts.type==="map"){return findMapChartCurrentIndex({x:t.x,y:t.y},this.opts)}else if(this.opts.type==="word"){return findWordChartCurrentIndex({x:t.x,y:t.y},this.opts.chartData.wordCloudData)}else if(this.opts.type==="bar"){return findBarChartCurrentIndex({x:t.x,y:t.y},this.opts.chartData.calPoints,this.opts,this.config,Math.abs(this.scrollOption.currentOffset))}else{return findCurrentIndex({x:t.x,y:t.y},this.opts.chartData.calPoints,this.opts,this.config,Math.abs(this.scrollOption.currentOffset))}}return-1};uCharts.prototype.getLegendDataIndex=function(e){var i=null;if(e.changedTouches){i=e.changedTouches[0]}else{i=e.mp.changedTouches[0]}if(i){let t=getTouches(i,this.opts,e);return findLegendIndex({x:t.x,y:t.y},this.opts.chartData.legendData)}return-1};uCharts.prototype.touchLegend=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=null;if(t.changedTouches){i=t.changedTouches[0]}else{i=t.mp.changedTouches[0]}if(i){var a=getTouches(i,this.opts,t);var r=this.getLegendDataIndex(t);if(r>=0){if(this.opts.type=="candle"){this.opts.seriesMA[r].show=!this.opts.seriesMA[r].show}else{this.opts.series[r].show=!this.opts.series[r].show}this.opts.animation=e.animation?true:false;this.opts._scrollDistance_=this.scrollOption.currentOffset;drawCharts.call(this,this.opts.type,this.opts,this.config,this.context)}}};uCharts.prototype.showToolTip=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=null;if(t.changedTouches){i=t.changedTouches[0]}else{i=t.mp.changedTouches[0]}if(!i){console.log("[uCharts] 未获取到event坐标信息")}var a=getTouches(i,this.opts,t);var h=this.scrollOption.currentOffset;var r=assign({},this.opts,{_scrollDistance_:h,animation:false});if(this.opts.type==="line"||this.opts.type==="area"||this.opts.type==="column"||this.opts.type==="scatter"||this.opts.type==="bubble"){var o=this.getCurrentDataIndex(t);var n=e.index==undefined?o.index:e.index;if(n>-1||n.length>0){var s=getSeriesDataItem(this.opts.series,n,o.group);if(s.length!==0){var c=getToolTipData(s,this.opts,n,o.group,this.opts.categories,e),x=c.textList,l=c.offset;l.y=a.y;r.tooltip={textList:e.textList!==undefined?e.textList:x,offset:e.offset!==undefined?e.offset:l,option:e,index:n}}}drawCharts.call(this,r.type,r,this.config,this.context)}if(this.opts.type==="pie"||this.opts.type==="ring"||this.opts.type==="rose"||this.opts.type==="funnel"){var n=e.index==undefined?this.getCurrentDataIndex(t):e.index;if(n>-1){var r=assign({},this.opts,{animation:false});var s=assign({},r._series_[n]);var x=[{text:e.formatter?e.formatter(s,undefined,n,r):s.name+": "+s.data,color:s.color}];var l={x:a.x,y:a.y};r.tooltip={textList:e.textList?e.textList:x,offset:e.offset!==undefined?e.offset:l,option:e,index:n}}drawCharts.call(this,r.type,r,this.config,this.context)}};uCharts.prototype.translate=function(t){this.scrollOption={currentOffset:t,startTouchX:t,distance:0,lastMoveTime:0};let e=assign({},this.opts,{_scrollDistance_:t,animation:false});drawCharts.call(this,this.opts.type,e,this.config,this.context)};uCharts.prototype.scrollStart=function(t){var e=null;if(t.changedTouches){e=t.changedTouches[0]}else{e=t.mp.changedTouches[0]}var i=getTouches(e,this.opts,t);if(e&&this.opts.enableScroll===true){this.scrollOption.startTouchX=i.x}};uCharts.prototype.scroll=function(t){if(this.scrollOption.lastMoveTime===0){this.scrollOption.lastMoveTime=Date.now()}let e=this.opts.touchMoveLimit||60;let i=Date.now();let a=i-this.scrollOption.lastMoveTime;if(a<Math.floor(1e3/e))return;if(this.scrollOption.startTouchX==0)return;this.scrollOption.lastMoveTime=i;var r=null;if(t.changedTouches){r=t.changedTouches[0]}else{r=t.mp.changedTouches[0]}if(r&&this.opts.enableScroll===true){var o=getTouches(r,this.opts,t);var n;n=o.x-this.scrollOption.startTouchX;var s=this.scrollOption.currentOffset;var l=calValidDistance(this,s+n,this.opts.chartData,this.config,this.opts);this.scrollOption.distance=n=l-s;var h=assign({},this.opts,{_scrollDistance_:s+n,animation:false});this.opts=h;drawCharts.call(this,h.type,h,this.config,this.context);return s+n}};uCharts.prototype.scrollEnd=function(t){if(this.opts.enableScroll===true){var e=this.scrollOption,i=e.currentOffset,a=e.distance;this.scrollOption.currentOffset=i+a;this.scrollOption.distance=0;this.scrollOption.moveCount=0}};export default uCharts;